{
  "repository_path": "/var/folders/35/2pz7vhmd2tbdwb73n7k07j7c0000gn/T/security_test_q31qkebm",
  "analysis_timestamp": "2025-09-26 18:34:42.827274",
  "keyword_analysis": {
    "total_files_processed": 5,
    "total_keywords_extracted": 966,
    "unique_keywords": 278,
    "filtered_keywords_count": 233,
    "keyword_frequency": {
      "subprocess": 4,
      "cryptography": 2,
      "fernet": 12,
      "key": 10,
      "bitcoin": 3,
      "wallet": 4,
      "bitcoin_wallet": 3,
      "crypto": 8,
      "locker": 10,
      "cryptolocker": 2,
      "init": 4,
      "self": 42,
      "encrypt": 6,
      "files": 6,
      "encrypt_files": 2,
      "target": 6,
      "dirs": 4,
      "target_dirs": 2,
      "dir": 2,
      "target_dir": 2,
      "root": 4,
      "walk": 2,
      "file": 12,
      "endswith": 2,
      "filepath": 12,
      "path": 14,
      "join": 6,
      "encrypt_file": 2,
      "open": 6,
      "read": 2,
      "encrypted": 4,
      "write": 4,
      "remove": 2,
      "drop": 2,
      "ransom": 4,
      "note": 2,
      "drop_ransom_note": 2,
      "message": 3,
      "ransom_message": 2,
      "desktop": 2,
      "paths": 2,
      "desktop_paths": 2,
      "expanduser": 2,
      "establish": 6,
      "persistence": 6,
      "establish_persistence": 4,
      "registry": 2,
      "cmd": 2,
      "registry_cmd": 2,
      "run": 2,
      "shell": 2,
      "true": 8,
      "name": 10,
      "require": 8,
      "web": 2,
      "socket": 6,
      "websocket": 2,
      "mining": 4,
      "pools": 2,
      "mining_pools": 2,
      "stratum": 2,
      "tcp": 2,
      "jacker": 2,
      "cryptojacker": 2,
      "constructor": 2,
      "hashrate": 6,
      "shares": 2,
      "submitted": 2,
      "shares_submitted": 2,
      "start": 4,
      "startmining": 2,
      "console": 2,
      "log": 4,
      "document": 4,
      "user": 3,
      "set": 3,
      "nonce": 4,
      "math": 2,
      "random": 2,
      "hash": 11,
      "update": 2,
      "digest": 2,
      "submit": 2,
      "share": 2,
      "submitshare": 2,
      "pool": 2,
      "url": 2,
      "pool_url": 2,
      "send": 5,
      "stringify": 4,
      "params": 2,
      "hide": 2,
      "process": 10,
      "hideprocess": 2,
      "platform": 2,
      "title": 4,
      "establishpersistence": 2,
      "startup": 2,
      "startup_path": 2,
      "env": 4,
      "appdata": 2,
      "sync": 2,
      "filename": 2,
      "cron": 2,
      "entry": 2,
      "cron_entry": 2,
      "append": 7,
      "miner": 8,
      "include": 12,
      "iostream": 2,
      "cstring": 2,
      "sys": 2,
      "netinet": 2,
      "unistd": 2,
      "server": 18,
      "backdoor": 3,
      "password": 9,
      "port": 3,
      "backdoor_port": 2,
      "remote": 2,
      "access": 2,
      "trojan": 2,
      "remoteaccesstrojan": 2,
      "sockfd": 8,
      "buffer": 12,
      "connect": 7,
      "connect_to_c2": 2,
      "inet": 2,
      "af_inet": 2,
      "sockaddr": 3,
      "addr": 5,
      "server_addr": 5,
      "sin": 2,
      "htons": 2,
      "execute": 4,
      "commands": 2,
      "execute_commands": 2,
      "memset": 2,
      "recv": 2,
      "command": 11,
      "strcpy": 2,
      "strcat": 2,
      "system": 16,
      "reg": 3,
      "reg_command": 3,
      "sprintf": 2,
      "privilege": 2,
      "escalation": 2,
      "privilege_escalation": 2,
      "add": 2,
      "group": 3,
      "member": 3,
      "username": 8,
      "lateral": 2,
      "movement": 2,
      "lateral_movement": 2,
      "main": 2,
      "rat": 12,
      "php": 2,
      "host": 2,
      "db_host": 2,
      "db_user": 2,
      "db_pass": 2,
      "db_name": 2,
      "post": 8,
      "query": 12,
      "conn": 10,
      "mysqli": 3,
      "mysqli_query": 2,
      "log_query": 2,
      "header": 3,
      "div": 4,
      "fill": 2,
      "all": 2,
      "xhr": 4,
      "script": 2,
      "head": 2,
      "body": 4,
      "secure": 2,
      "online": 2,
      "banking": 2,
      "form": 4,
      "onsubmit": 2,
      "type": 6,
      "placeholder": 4,
      "required": 4,
      "button": 4,
      "login": 4,
      "sqlite3": 4,
      "smtplib": 4,
      "email": 10,
      "mime": 2,
      "mimetext": 4,
      "email_password": 2,
      "smtp": 4,
      "smtp_server": 2,
      "credential": 2,
      "harvester": 2,
      "credentialharvester": 2,
      "logged": 5,
      "logged_data": 5,
      "steal": 2,
      "browser": 2,
      "passwords": 6,
      "steal_browser_passwords": 2,
      "chrome": 2,
      "chrome_db": 2,
      "cursor": 8,
      "fetchall": 2,
      "keylogger": 2,
      "hook": 2,
      "keylogger_hook": 2,
      "pynput": 4,
      "keyboard": 4,
      "press": 3,
      "on_key_press": 2,
      "listener": 6,
      "clipboard": 8,
      "pyperclip": 4,
      "previous": 3,
      "previous_clipboard": 3,
      "current": 4,
      "current_clipboard": 4,
      "paste": 2,
      "any": 2,
      "keyword": 4,
      "lower": 2,
      "exfiltrate": 2,
      "exfiltrate_data": 2,
      "msg": 10,
      "starttls": 2,
      "quit": 2,
      "stealer": 8
    },
    "malicious_keywords": {
      "subprocess": 4,
      "cryptography": 2,
      "bitcoin": 3,
      "bitcoin_wallet": 3,
      "crypto": 8,
      "cryptolocker": 2,
      "encrypt": 6,
      "encrypt_files": 2,
      "encrypt_file": 2,
      "encrypted": 4,
      "ransom": 4,
      "persistence": 6,
      "establish_persistence": 4,
      "registry": 2,
      "registry_cmd": 2,
      "shell": 2,
      "socket": 6,
      "websocket": 2,
      "cryptojacker": 2,
      "start": 4,
      "hash": 11,
      "send": 5,
      "hide": 2,
      "process": 10,
      "establishpersistence": 2,
      "startup": 2,
      "startup_path": 2,
      "miner": 8,
      "backdoor": 3,
      "backdoor_port": 2,
      "remote": 2,
      "access": 2,
      "trojan": 2,
      "remoteaccesstrojan": 2,
      "connect": 7,
      "connect_to_c2": 2,
      "execute": 4,
      "execute_commands": 2,
      "recv": 2,
      "command": 11,
      "system": 16,
      "privilege": 2,
      "escalation": 2,
      "privilege_escalation": 2,
      "lateral": 2,
      "movement": 2,
      "lateral_movement": 2,
      "rat": 12,
      "harvester": 2,
      "credentialharvester": 2,
      "steal": 2,
      "steal_browser_passwords": 2,
      "keylogger": 2,
      "keylogger_hook": 2,
      "listener": 6,
      "clipboard": 8,
      "previous_clipboard": 3,
      "current_clipboard": 4,
      "exfiltrate": 2,
      "exfiltrate_data": 2,
      "stealer": 8
    },
    "malicious_score": 0.428,
    "top_keywords": {
      "self": 42,
      "server": 18,
      "system": 16,
      "path": 14,
      "fernet": 12,
      "file": 12,
      "filepath": 12,
      "include": 12,
      "buffer": 12,
      "rat": 12,
      "query": 12,
      "hash": 11,
      "command": 11,
      "key": 10,
      "locker": 10,
      "name": 10,
      "process": 10,
      "conn": 10,
      "email": 10,
      "msg": 10,
      "password": 9,
      "crypto": 8,
      "true": 8,
      "require": 8,
      "miner": 8,
      "sockfd": 8,
      "username": 8,
      "post": 8,
      "cursor": 8,
      "clipboard": 8,
      "stealer": 8,
      "append": 7,
      "connect": 7,
      "encrypt": 6,
      "files": 6,
      "target": 6,
      "join": 6,
      "open": 6,
      "establish": 6,
      "persistence": 6,
      "socket": 6,
      "hashrate": 6,
      "type": 6,
      "passwords": 6,
      "listener": 6,
      "send": 5,
      "addr": 5,
      "server_addr": 5,
      "logged": 5,
      "logged_data": 5
    },
    "keywords_by_file": {
      "ransomware.py": [
        "subprocess",
        "subprocess",
        "cryptography",
        "cryptography",
        "fernet",
        "fernet",
        "fernet",
        "fernet",
        "encryption",
        "key",
        "encryption_key",
        "bitcoin",
        "wallet",
        "bitcoin_wallet",
        "crypto",
        "locker",
        "cryptolocker",
        "init",
        "init",
        "self",
        "self",
        "self",
        "self",
        "key",
        "key",
        "fernet",
        "fernet",
        "generate",
        "key",
        "generate_key",
        "encrypt",
        "files",
        "encrypt_files",
        "self",
        "self",
        "target",
        "dirs",
        "target_dirs",
        "target",
        "dir",
        "target_dir",
        "target",
        "dirs",
        "target_dirs",
        "root",
        "root",
        "dirs",
        "dirs",
        "files",
        "files",
        "walk",
        "walk",
        "target",
        "dir",
        "target_dir",
        "file",
        "file",
        "files",
        "files",
        "file",
        "file",
        "endswith",
        "endswith",
        "filepath",
        "filepath",
        "path",
        "path",
        "join",
        "join",
        "root",
        "root",
        "file",
        "file",
        "self",
        "self",
        "encrypt",
        "file",
        "encrypt_file",
        "filepath",
        "filepath",
        "encrypt",
        "file",
        "encrypt_file",
        "self",
        "self",
        "filepath",
        "filepath",
        "fernet",
        "fernet",
        "fernet",
        "fernet",
        "self",
        "self",
        "key",
        "key",
        "open",
        "open",
        "filepath",
        "filepath",
        "read",
        "read",
        "encrypted",
        "encrypted",
        "fernet",
        "fernet",
        "encrypt",
        "encrypt",
        "open",
        "open",
        "filepath",
        "filepath",
        "write",
        "write",
        "encrypted",
        "encrypted",
        "remove",
        "remove",
        "filepath",
        "filepath",
        "drop",
        "ransom",
        "note",
        "drop_ransom_note",
        "self",
        "self",
        "ransom",
        "message",
        "ransom_message",
        "desktop",
        "paths",
        "desktop_paths",
        "path",
        "path",
        "expanduser",
        "expanduser",
        "path",
        "path",
        "desktop",
        "paths",
        "desktop_paths",
        "open",
        "open",
        "path",
        "path",
        "write",
        "write",
        "ransom",
        "message",
        "ransom_message",
        "establish",
        "persistence",
        "establish_persistence",
        "self",
        "self",
        "registry",
        "cmd",
        "registry_cmd",
        "subprocess",
        "subprocess",
        "run",
        "run",
        "registry",
        "cmd",
        "registry_cmd",
        "shell",
        "shell",
        "true",
        "true",
        "name",
        "name",
        "locker",
        "locker",
        "crypto",
        "locker",
        "cryptolocker",
        "locker",
        "locker",
        "encrypt",
        "files",
        "encrypt_files",
        "locker",
        "locker",
        "drop",
        "ransom",
        "note",
        "drop_ransom_note",
        "locker",
        "locker",
        "establish",
        "persistence",
        "establish_persistence"
      ],
      "cryptominer.js": [
        "crypto",
        "crypto",
        "require",
        "require",
        "web",
        "socket",
        "websocket",
        "require",
        "require",
        "bitcoin",
        "wallet",
        "bitcoin_wallet",
        "ethereum",
        "wallet",
        "ethereum_wallet",
        "mining",
        "pools",
        "mining_pools",
        "stratum",
        "stratum",
        "tcp",
        "tcp",
        "crypto",
        "jacker",
        "cryptojacker",
        "constructor",
        "constructor",
        "hashrate",
        "hashrate",
        "shares",
        "submitted",
        "shares_submitted",
        "start",
        "mining",
        "startmining",
        "console",
        "console",
        "log",
        "log",
        "document",
        "document",
        "document",
        "document",
        "inner",
        "innerhtml",
        "user",
        "user_input",
        "set",
        "interval",
        "setinterval",
        "nonce",
        "nonce",
        "math",
        "math",
        "random",
        "random",
        "tostring",
        "nonce",
        "nonce",
        "hash",
        "hash",
        "crypto",
        "crypto",
        "create",
        "hash",
        "createhash",
        "update",
        "update",
        "digest",
        "digest",
        "hash",
        "hash",
        "starts",
        "startswith",
        "submit",
        "share",
        "submitshare",
        "hash",
        "hash",
        "hashrate",
        "hashrate",
        "submit",
        "share",
        "submitshare",
        "hash",
        "hash",
        "pool",
        "url",
        "pool_url",
        "mining",
        "pools",
        "mining_pools",
        "web",
        "socket",
        "websocket",
        "pool",
        "url",
        "pool_url",
        "send",
        "send",
        "stringify",
        "stringify",
        "params",
        "params",
        "bitcoin",
        "wallet",
        "bitcoin_wallet",
        "hash",
        "hash",
        "shares",
        "submitted",
        "shares_submitted",
        "hide",
        "process",
        "hideprocess",
        "process",
        "process",
        "platform",
        "platform",
        "process",
        "process",
        "title",
        "title",
        "process",
        "process",
        "title",
        "title",
        "hashrate",
        "hashrate",
        "set",
        "timeout",
        "settimeout",
        "establish",
        "persistence",
        "establishpersistence",
        "require",
        "require",
        "path",
        "path",
        "require",
        "require",
        "startup",
        "path",
        "startup_path",
        "path",
        "path",
        "join",
        "join",
        "process",
        "process",
        "env",
        "env",
        "appdata",
        "appdata",
        "copy",
        "file",
        "sync",
        "copyfilesync",
        "filename",
        "filename",
        "startup",
        "path",
        "startup_path",
        "cron",
        "entry",
        "cron_entry",
        "append",
        "file",
        "sync",
        "appendfilesync",
        "cron",
        "entry",
        "cron_entry",
        "miner",
        "miner",
        "crypto",
        "jacker",
        "cryptojacker",
        "miner",
        "miner",
        "hide",
        "process",
        "hideprocess",
        "miner",
        "miner",
        "start",
        "mining",
        "startmining",
        "miner",
        "miner",
        "establish",
        "persistence",
        "establishpersistence"
      ],
      "backdoor.cpp": [
        "include",
        "include",
        "iostream",
        "iostream",
        "include",
        "include",
        "include",
        "include",
        "cstring",
        "cstring",
        "include",
        "include",
        "sys",
        "sys",
        "socket",
        "socket",
        "include",
        "include",
        "netinet",
        "netinet",
        "include",
        "include",
        "unistd",
        "unistd",
        "server",
        "c2_server",
        "backdoor",
        "password",
        "backdoor_password",
        "backdoor",
        "port",
        "backdoor_port",
        "remote",
        "access",
        "trojan",
        "remoteaccesstrojan",
        "sockfd",
        "sockfd",
        "buffer",
        "buffer",
        "connect",
        "connect_to_c2",
        "sockfd",
        "sockfd",
        "socket",
        "socket",
        "inet",
        "af_inet",
        "sock",
        "stream",
        "sock_stream",
        "sockaddr",
        "sockaddr_in",
        "server",
        "addr",
        "server_addr",
        "server",
        "addr",
        "server_addr",
        "sin",
        "family",
        "sin_family",
        "inet",
        "af_inet",
        "server",
        "addr",
        "server_addr",
        "sin",
        "port",
        "sin_port",
        "htons",
        "htons",
        "backdoor",
        "port",
        "backdoor_port",
        "connect",
        "connect",
        "sockfd",
        "sockfd",
        "sockaddr",
        "sockaddr",
        "server",
        "addr",
        "server_addr",
        "server",
        "addr",
        "server_addr",
        "execute",
        "commands",
        "execute_commands",
        "true",
        "true",
        "memset",
        "memset",
        "buffer",
        "buffer",
        "buffer",
        "buffer",
        "recv",
        "recv",
        "sockfd",
        "sockfd",
        "buffer",
        "buffer",
        "buffer",
        "buffer",
        "command",
        "command",
        "strcpy",
        "strcpy",
        "command",
        "command",
        "strcat",
        "strcat",
        "command",
        "command",
        "buffer",
        "buffer",
        "system",
        "system",
        "command",
        "command",
        "establish",
        "persistence",
        "establish_persistence",
        "reg",
        "command",
        "reg_command",
        "sprintf",
        "sprintf",
        "reg",
        "command",
        "reg_command",
        "file",
        "file",
        "system",
        "system",
        "reg",
        "command",
        "reg_command",
        "system",
        "system",
        "privilege",
        "escalation",
        "privilege_escalation",
        "system",
        "system",
        "add",
        "add",
        "local",
        "group",
        "member",
        "localgroupmember",
        "group",
        "group",
        "member",
        "member",
        "env",
        "env",
        "username",
        "username",
        "system",
        "system",
        "system",
        "system",
        "lateral",
        "movement",
        "lateral_movement",
        "system",
        "system",
        "system",
        "system",
        "main",
        "main",
        "remote",
        "access",
        "trojan",
        "remoteaccesstrojan",
        "rat",
        "rat",
        "rat",
        "rat",
        "connect",
        "connect_to_c2",
        "rat",
        "rat",
        "establish",
        "persistence",
        "establish_persistence",
        "rat",
        "rat",
        "privilege",
        "escalation",
        "privilege_escalation",
        "rat",
        "rat",
        "lateral",
        "movement",
        "lateral_movement",
        "rat",
        "rat",
        "execute",
        "commands",
        "execute_commands"
      ],
      "phishing_site.php": [
        "php",
        "php",
        "host",
        "db_host",
        "user",
        "db_user",
        "db_pass",
        "name",
        "db_name",
        "post",
        "post",
        "post",
        "post",
        "username",
        "username",
        "post",
        "post",
        "password",
        "password",
        "post",
        "post",
        "query",
        "query",
        "conn",
        "conn",
        "mysqli",
        "connect",
        "mysqli_connect",
        "host",
        "db_host",
        "user",
        "db_user",
        "db_pass",
        "name",
        "db_name",
        "mysqli",
        "query",
        "mysqli_query",
        "conn",
        "conn",
        "query",
        "query",
        "log",
        "query",
        "log_query",
        "mysqli",
        "query",
        "mysqli_query",
        "conn",
        "conn",
        "log",
        "query",
        "log_query",
        "header",
        "header",
        "div",
        "div",
        "div",
        "div",
        "fill",
        "fill",
        "all",
        "all",
        "fields",
        "posthttps",
        "fieldsposthttps",
        "xhr",
        "xhr",
        "set",
        "request",
        "header",
        "setrequestheader",
        "xhr",
        "xhr",
        "send",
        "send",
        "stringify",
        "stringify",
        "username",
        "username",
        "username",
        "username",
        "password",
        "password",
        "password",
        "password",
        "target",
        "target",
        "true",
        "true",
        "script",
        "script",
        "head",
        "head",
        "body",
        "body",
        "secure",
        "secure",
        "online",
        "online",
        "banking",
        "banking",
        "form",
        "form",
        "name",
        "name",
        "onsubmit",
        "onsubmit",
        "type",
        "type",
        "name",
        "name",
        "placeholder",
        "placeholder",
        "required",
        "required",
        "type",
        "type",
        "name",
        "name",
        "placeholder",
        "placeholder",
        "required",
        "required",
        "button",
        "button",
        "type",
        "type",
        "login",
        "login",
        "button",
        "button",
        "form",
        "form",
        "body",
        "body"
      ],
      "keylogger.py": [
        "sqlite3",
        "sqlite3",
        "smtplib",
        "smtplib",
        "email",
        "email",
        "mime",
        "mime",
        "mimetext",
        "mimetext",
        "email",
        "password",
        "email_password",
        "smtp",
        "server",
        "smtp_server",
        "credential",
        "harvester",
        "credentialharvester",
        "init",
        "init",
        "self",
        "self",
        "self",
        "self",
        "logged",
        "logged_data",
        "self",
        "self",
        "email",
        "email",
        "steal",
        "browser",
        "passwords",
        "steal_browser_passwords",
        "self",
        "self",
        "chrome",
        "chrome_db",
        "query",
        "query",
        "conn",
        "conn",
        "sqlite3",
        "sqlite3",
        "connect",
        "connect",
        "chrome",
        "chrome_db",
        "cursor",
        "cursor",
        "conn",
        "conn",
        "cursor",
        "cursor",
        "cursor",
        "cursor",
        "execute",
        "execute",
        "query",
        "query",
        "passwords",
        "passwords",
        "cursor",
        "cursor",
        "fetchall",
        "fetchall",
        "passwords",
        "passwords",
        "keylogger",
        "hook",
        "keylogger_hook",
        "self",
        "self",
        "pynput",
        "pynput",
        "pynput",
        "pynput",
        "keyboard",
        "keyboard",
        "key",
        "press",
        "on_key_press",
        "key",
        "key",
        "self",
        "self",
        "logged",
        "logged_data",
        "append",
        "append",
        "attribute",
        "error",
        "attributeerror",
        "self",
        "self",
        "logged",
        "logged_data",
        "append",
        "append",
        "listener",
        "listener",
        "keyboard",
        "keyboard",
        "listener",
        "listener",
        "press",
        "on_press",
        "key",
        "press",
        "on_key_press",
        "listener",
        "listener",
        "start",
        "start",
        "harvest",
        "clipboard",
        "harvest_clipboard",
        "self",
        "self",
        "pyperclip",
        "pyperclip",
        "previous",
        "clipboard",
        "previous_clipboard",
        "true",
        "true",
        "current",
        "clipboard",
        "current_clipboard",
        "pyperclip",
        "pyperclip",
        "paste",
        "paste",
        "current",
        "clipboard",
        "current_clipboard",
        "previous",
        "clipboard",
        "previous_clipboard",
        "any",
        "any",
        "keyword",
        "keyword",
        "current",
        "clipboard",
        "current_clipboard",
        "lower",
        "lower",
        "keyword",
        "keyword",
        "self",
        "self",
        "logged",
        "logged_data",
        "append",
        "append",
        "previous",
        "clipboard",
        "previous_clipboard",
        "current",
        "clipboard",
        "current_clipboard",
        "exfiltrate",
        "exfiltrate_data",
        "self",
        "self",
        "join",
        "join",
        "self",
        "self",
        "logged",
        "logged_data",
        "msg",
        "msg",
        "mimetext",
        "mimetext",
        "msg",
        "msg",
        "msg",
        "msg",
        "self",
        "self",
        "email",
        "email",
        "msg",
        "msg",
        "server",
        "server",
        "smtplib",
        "smtplib",
        "smtp",
        "smtp",
        "smtp",
        "server",
        "smtp_server",
        "server",
        "server",
        "starttls",
        "starttls",
        "server",
        "server",
        "login",
        "login",
        "self",
        "self",
        "email",
        "email",
        "email",
        "password",
        "email_password",
        "server",
        "server",
        "send",
        "message",
        "send_message",
        "msg",
        "msg",
        "server",
        "server",
        "quit",
        "quit",
        "stealer",
        "stealer",
        "credential",
        "harvester",
        "credentialharvester",
        "stealer",
        "stealer",
        "steal",
        "browser",
        "passwords",
        "steal_browser_passwords",
        "stealer",
        "stealer",
        "keylogger",
        "hook",
        "keylogger_hook",
        "stealer",
        "stealer",
        "exfiltrate",
        "exfiltrate_data"
      ]
    }
  },
  "yara_analysis": {
    "total_files_scanned": 5,
    "total_matches": 16,
    "matches_by_category": {
      "backdoor": 3,
      "exploit": 5,
      "ransomware": 1,
      "cryptominer": 2,
      "evasion": 1,
      "botnet": 1,
      "keylogger": 2,
      "network": 1
    },
    "matches_by_severity": {
      "high": 11,
      "critical": 1,
      "medium": 4
    },
    "file_matches": {
      "ransomware.py": [
        {
          "rule_name": "Backdoor_Patterns",
          "category": "backdoor",
          "severity": "high",
          "description": "Detects common backdoor and RAT patterns",
          "strings": [
            {
              "identifier": "$reverse_shell_2",
              "instances": 1
            },
            {
              "identifier": "$persistence_registry",
              "instances": 1
            }
          ]
        },
        {
          "rule_name": "Exploit_Patterns",
          "category": "exploit",
          "severity": "high",
          "description": "Detects exploit patterns and vulnerability usage",
          "strings": [
            {
              "identifier": "$injection_1",
              "instances": 2
            },
            {
              "identifier": "$injection_2",
              "instances": 2
            },
            {
              "identifier": "$vulnerability",
              "instances": 3
            }
          ]
        },
        {
          "rule_name": "Ransomware_Patterns",
          "category": "ransomware",
          "severity": "critical",
          "description": "Detects ransomware patterns and behaviors",
          "strings": [
            {
              "identifier": "$encrypt_1",
              "instances": 4
            },
            {
              "identifier": "$encrypt_2",
              "instances": 3
            },
            {
              "identifier": "$ransom_1",
              "instances": 7
            },
            {
              "identifier": "$ransom_2",
              "instances": 1
            },
            {
              "identifier": "$ransom_3",
              "instances": 2
            },
            {
              "identifier": "$file_ext_change",
              "instances": 1
            },
            {
              "identifier": "$bitcoin_demand",
              "instances": 3
            },
            {
              "identifier": "$file_destruction",
              "instances": 2
            }
          ]
        },
        {
          "rule_name": "Cryptocurrency_Miner",
          "category": "cryptominer",
          "severity": "medium",
          "description": "Detects cryptocurrency mining patterns",
          "strings": [
            {
              "identifier": "$wallet_1",
              "instances": 1
            }
          ]
        }
      ],
      "cryptominer.js": [
        {
          "rule_name": "Backdoor_Patterns",
          "category": "backdoor",
          "severity": "high",
          "description": "Detects common backdoor and RAT patterns",
          "strings": [
            {
              "identifier": "$persistence_startup",
              "instances": 3
            }
          ]
        },
        {
          "rule_name": "Exploit_Patterns",
          "category": "exploit",
          "severity": "high",
          "description": "Detects exploit patterns and vulnerability usage",
          "strings": [
            {
              "identifier": "$vulnerability",
              "instances": 2
            }
          ]
        },
        {
          "rule_name": "Cryptocurrency_Miner",
          "category": "cryptominer",
          "severity": "medium",
          "description": "Detects cryptocurrency mining patterns",
          "strings": [
            {
              "identifier": "$mining_2",
              "instances": 4
            },
            {
              "identifier": "$mining_3",
              "instances": 2
            },
            {
              "identifier": "$mining_4",
              "instances": 3
            },
            {
              "identifier": "$wallet_1",
              "instances": 3
            }
          ]
        },
        {
          "rule_name": "Steganography_Hiding",
          "category": "evasion",
          "severity": "medium",
          "description": "Detects steganography and data hiding techniques",
          "strings": [
            {
              "identifier": "$obfuscation",
              "instances": 1
            }
          ]
        }
      ],
      "backdoor.cpp": [
        {
          "rule_name": "Backdoor_Patterns",
          "category": "backdoor",
          "severity": "high",
          "description": "Detects common backdoor and RAT patterns",
          "strings": [
            {
              "identifier": "$c2_communication",
              "instances": 2
            },
            {
              "identifier": "$persistence_registry",
              "instances": 1
            },
            {
              "identifier": "$remote_access",
              "instances": 2
            }
          ]
        },
        {
          "rule_name": "Exploit_Patterns",
          "category": "exploit",
          "severity": "high",
          "description": "Detects exploit patterns and vulnerability usage",
          "strings": [
            {
              "identifier": "$exploit_1",
              "instances": 2
            },
            {
              "identifier": "$buffer_overflow",
              "instances": 1
            },
            {
              "identifier": "$injection_1",
              "instances": 3
            },
            {
              "identifier": "$injection_2",
              "instances": 2
            },
            {
              "identifier": "$privilege_esc",
              "instances": 2
            },
            {
              "identifier": "$vulnerability",
              "instances": 3
            }
          ]
        },
        {
          "rule_name": "Network_Scanner_Botnet",
          "category": "botnet",
          "severity": "high",
          "description": "Detects network scanning and botnet patterns",
          "strings": [
            {
              "identifier": "$network_scan",
              "instances": 1
            }
          ]
        }
      ],
      "phishing_site.php": [
        {
          "rule_name": "Keylogger_Patterns",
          "category": "keylogger",
          "severity": "high",
          "description": "Detects keylogger patterns and behaviors",
          "strings": [
            {
              "identifier": "$credential_1",
              "instances": 1
            }
          ]
        },
        {
          "rule_name": "Exploit_Patterns",
          "category": "exploit",
          "severity": "high",
          "description": "Detects exploit patterns and vulnerability usage",
          "strings": [
            {
              "identifier": "$injection_1",
              "instances": 2
            },
            {
              "identifier": "$injection_2",
              "instances": 2
            },
            {
              "identifier": "$vulnerability",
              "instances": 8
            }
          ]
        }
      ],
      "keylogger.py": [
        {
          "rule_name": "Keylogger_Patterns",
          "category": "keylogger",
          "severity": "high",
          "description": "Detects keylogger patterns and behaviors",
          "strings": [
            {
              "identifier": "$keylog_1",
              "instances": 1
            },
            {
              "identifier": "$keylog_2",
              "instances": 1
            },
            {
              "identifier": "$keylog_5",
              "instances": 3
            },
            {
              "identifier": "$clipboard_1",
              "instances": 11
            },
            {
              "identifier": "$credential_1",
              "instances": 2
            }
          ]
        },
        {
          "rule_name": "Exploit_Patterns",
          "category": "exploit",
          "severity": "high",
          "description": "Detects exploit patterns and vulnerability usage",
          "strings": [
            {
              "identifier": "$injection_1",
              "instances": 2
            },
            {
              "identifier": "$injection_2",
              "instances": 2
            },
            {
              "identifier": "$vulnerability",
              "instances": 2
            }
          ]
        },
        {
          "rule_name": "Suspicious_Network_Activity",
          "category": "network",
          "severity": "medium",
          "description": "Detects suspicious network communication patterns",
          "strings": [
            {
              "identifier": "$exfiltration",
              "instances": 3
            }
          ]
        }
      ]
    },
    "rule_statistics": {},
    "threat_score": 1.0,
    "detected_categories": [
      "evasion",
      "botnet",
      "keylogger",
      "network",
      "backdoor",
      "cryptominer",
      "exploit",
      "ransomware"
    ]
  },
  "vulnerability_analysis": {
    "repository_path": "/var/folders/35/2pz7vhmd2tbdwb73n7k07j7c0000gn/T/security_test_q31qkebm",
    "scan_timestamp": "2025-09-26 18:34:42.868415",
    "files_scanned": 5,
    "total_findings": 11,
    "findings_by_severity": {
      "medium": 2,
      "high": 9
    },
    "findings_by_category": {
      "injection": 2,
      "xss": 1,
      "crypto": 2,
      "secrets": 3,
      "buffer_overflow": 3
    },
    "findings_by_file": {
      "ransomware.py": [
        {
          "rule_id": "CMD_INJECTION_002",
          "title": "Shell Command Execution Enabled",
          "severity": "medium",
          "line_number": 69,
          "code_snippet": "subprocess.run(registry_cmd, shell=True)  # Vulnerable to command injection"
        }
      ],
      "cryptominer.js": [
        {
          "rule_id": "XSS_001",
          "title": "Potential XSS via innerHTML",
          "severity": "medium",
          "line_number": 27,
          "code_snippet": "document.innerHTML = \"<div>\" + user_input + \"</div>\";  // XSS vulnerability"
        }
      ],
      "backdoor.cpp": [
        {
          "rule_id": "CRYPTO_002",
          "title": "Weak Password/Key",
          "severity": "high",
          "line_number": 11,
          "code_snippet": "const char* BACKDOOR_PASSWORD = \"admin123\";  // Weak password"
        },
        {
          "rule_id": "INFO_DISCLOSURE_001",
          "title": "Hardcoded Sensitive Information",
          "severity": "high",
          "line_number": 11,
          "code_snippet": "const char* BACKDOOR_PASSWORD = \"admin123\";  // Weak password"
        },
        {
          "rule_id": "BUFFER_OVERFLOW_001",
          "title": "Unsafe C String Function",
          "severity": "high",
          "line_number": 37,
          "code_snippet": "strcpy(command, \"cmd.exe /c \");  // Buffer overflow risk"
        },
        {
          "rule_id": "BUFFER_OVERFLOW_001",
          "title": "Unsafe C String Function",
          "severity": "high",
          "line_number": 38,
          "code_snippet": "strcat(command, buffer);         // Unsafe string concatenation"
        },
        {
          "rule_id": "BUFFER_OVERFLOW_001",
          "title": "Unsafe C String Function",
          "severity": "high",
          "line_number": 47,
          "code_snippet": "sprintf(reg_command, \"reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run /v SystemUpdate /d %s\", __FILE__);"
        }
      ],
      "phishing_site.php": [
        {
          "rule_id": "INFO_DISCLOSURE_001",
          "title": "Hardcoded Sensitive Information",
          "severity": "high",
          "line_number": 51,
          "code_snippet": "var api_key = \"sk-1234567890abcdef\";  // Hardcoded API key"
        }
      ],
      "keylogger.py": [
        {
          "rule_id": "CRYPTO_002",
          "title": "Weak Password/Key",
          "severity": "high",
          "line_number": 7,
          "code_snippet": "email_password = \"admin123\"  # Weak password"
        },
        {
          "rule_id": "INFO_DISCLOSURE_001",
          "title": "Hardcoded Sensitive Information",
          "severity": "high",
          "line_number": 7,
          "code_snippet": "email_password = \"admin123\"  # Weak password"
        },
        {
          "rule_id": "SQL_INJECTION_001",
          "title": "Potential SQL Injection via String Concatenation",
          "severity": "high",
          "line_number": 18,
          "code_snippet": "query = \"SELECT origin_url, username_value, password_value FROM logins WHERE username_value = '\" + input(\"Enter username: \") + \"'\""
        }
      ]
    },
    "risk_score": 7.1,
    "risk_level": "HIGH",
    "threshold_used": "medium",
    "top_categories": [
      [
        "secrets",
        3
      ],
      [
        "buffer_overflow",
        3
      ],
      [
        "injection",
        2
      ],
      [
        "crypto",
        2
      ],
      [
        "xss",
        1
      ]
    ]
  },
  "combined_assessment": {
    "combined_score": 0.741,
    "risk_level": "CRITICAL",
    "confidence": 1.0,
    "threat_indicators": [
      "High number of malicious keywords (61)",
      "Multiple YARA rule matches (16)",
      "Ransomware patterns detected",
      "Backdoor patterns detected",
      "Multiple high-severity vulnerabilities (9)"
    ],
    "recommendations": [
      "URGENT: Repository shows strong indicators of malicious code. Immediate investigation required.",
      "Isolate and quarantine the repository until thorough manual review is completed.",
      "High concentration of malicious keywords detected. Review code for potential threats.",
      "Ransomware patterns detected. Check for file encryption or ransom note functionality.",
      "Backdoor patterns detected. Verify network communication and remote access functionality.",
      "Keylogger patterns detected. Check for credential theft or surveillance functionality.",
      "Cryptocurrency mining patterns detected. Check for unauthorized resource usage.",
      "High-severity vulnerabilities found (9). Schedule security fixes.",
      "Injection vulnerabilities found. Implement input validation and parameterized queries.",
      "Cryptographic issues found. Review encryption implementations and key management.",
      "Hardcoded secrets detected. Move sensitive data to environment variables or secure storage.",
      "Consider implementing automated security scanning in CI/CD pipeline."
    ],
    "summary": {
      "keyword_malicious_terms": 61,
      "yara_pattern_matches": 16,
      "yara_threat_categories": [
        "evasion",
        "botnet",
        "keylogger",
        "network",
        "backdoor",
        "cryptominer",
        "exploit",
        "ransomware"
      ],
      "vulnerability_count": 11,
      "critical_vulnerabilities": 0,
      "high_vulnerabilities": 9
    },
    "analysis_coverage": {
      "files_analyzed_keywords": 5,
      "files_analyzed_yara": 5,
      "files_analyzed_vulnerabilities": 5
    }
  }
}