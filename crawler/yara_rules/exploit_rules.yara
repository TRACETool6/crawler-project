
rule Exploit_Patterns
{
    meta:
        description = "Detects exploit patterns and vulnerability usage"
        category = "exploit"
        severity = "high"
    
    strings:
        $exploit_1 = /exploit/i
        $payload_1 = /payload/i
        $shellcode = /shellcode/i
        $buffer_overflow = /buffer.{0,20}overflow/i
        $injection_1 = /(sql|code|command).{0,20}injection/i
        $injection_2 = /inject/i
        $privilege_esc = /privilege.{0,20}escalat/i
        $zero_day = /zero.{0,5}day/i
        $vulnerability = /vulnerabilit/i
        $rce = /(remote|code).{0,20}execut/i
        
    condition:
        any of them
}

rule Suspicious_Network_Activity
{
    meta:
        description = "Detects suspicious network communication patterns"
        category = "network"
        severity = "medium"
    
    strings:
        $suspicious_url_1 = /https?:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/
        $suspicious_url_2 = /[a-z0-9]{10,}\.tk|\.ml|\.ga|\.cf/i
        $tor_hidden = /[a-z2-7]{16}\.onion/i
        $exfiltration = /exfiltrat/i
        $beacon = /beacon/i
        $tunnel = /tunnel/i
        $proxy_chain = /proxy.{0,20}chain/i
        
    condition:
        any of them
}
